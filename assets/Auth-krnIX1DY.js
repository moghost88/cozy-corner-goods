var j=(a,p,r)=>new Promise((x,o)=>{var g=i=>{try{h(r.next(i))}catch(c){o(c)}},m=i=>{try{h(r.throw(i))}catch(c){o(c)}},h=i=>i.done?x(i.value):Promise.resolve(i.value).then(g,m);h((r=r.apply(a,p)).next())});import{j as e}from"./ui-components-Cwvw8Ahd.js";import{r as u,d as T,L as B}from"./react-vendor-CGklD7G4.js";import{b as P,u as U,d as M,s as q}from"./index-BA8FsFh7.js";import{l as z,I as N,B as L}from"./logo-BrdLi5QD.js";import{L as w}from"./label-DMVRMaUU.js";import{U as D,M as H,h as O,L as R,i as Z,A as G}from"./icons-Om4nLF3E.js";import{o as W,s as b,Z as $}from"./forms-DTL6punl.js";import"./utils-RvYD77G1.js";import"./supabase-CLqt2Rfr.js";const S=W({email:b().trim().email({message:"Invalid email address"}).max(255),password:b().min(6,{message:"Password must be at least 6 characters"}).max(100),displayName:b().trim().max(100).optional()}),ae=()=>{const[a,p]=u.useState(!0),[r,x]=u.useState(""),[o,g]=u.useState(""),[m,h]=u.useState(""),[i,c]=u.useState(!1),[d,v]=u.useState({}),{signIn:A,signUp:C}=P(),{t:s,dir:k}=U(),y=T(),{toast:n}=M(),E=k==="rtl"?Z:G,I=()=>{try{return a?S.pick({email:!0,password:!0}).parse({email:r,password:o}):S.parse({email:r,password:o,displayName:m||void 0}),v({}),!0}catch(t){if(t instanceof $){const l={};t.errors.forEach(f=>{f.path[0]&&(l[f.path[0]]=f.message)}),v(l)}return!1}},F=t=>j(void 0,null,function*(){if(t.preventDefault(),!!I()){c(!0);try{if(a){const{error:l}=yield A(r,o);l?l.message.includes("Invalid login credentials")?n({title:s("auth.loginFailed"),description:s("auth.invalidCredentials"),variant:"destructive"}):n({title:s("auth.loginFailed"),description:l.message,variant:"destructive"}):(n({title:s("auth.welcomeBackToast"),description:s("auth.successLogin")}),y("/"))}else{const{error:l}=yield C(r,o,m);l?l.message.includes("already registered")?n({title:s("auth.accountExists"),description:s("auth.accountExists"),variant:"destructive"}):n({title:s("auth.signUpFailed"),description:l.message,variant:"destructive"}):(n({title:s("auth.accountCreated"),description:s("auth.welcomeToStore")}),y("/"))}}finally{c(!1)}}});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -left-40 -top-40 h-80 w-80 rounded-full bg-primary/10 blur-3xl"}),e.jsx("div",{className:"absolute -right-40 top-20 h-96 w-96 rounded-full bg-secondary/10 blur-3xl"})]}),e.jsx("div",{className:"container relative mx-auto flex min-h-screen items-center justify-center px-4 py-12",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs(B,{to:"/",className:"mb-8 inline-flex items-center gap-2 text-sm text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(E,{className:"h-4 w-4"}),s("auth.backToHome")]}),e.jsxs("div",{className:"rounded-3xl border border-border bg-card p-8 shadow-card",children:[e.jsx("div",{className:"mb-6 flex items-center justify-center",children:e.jsx("img",{src:z,alt:"معرض الطباخ",className:"h-16 w-16 rounded-xl object-contain"})}),e.jsx("h1",{className:"mb-2 text-center font-display text-2xl font-bold text-foreground",children:s(a?"auth.welcomeBack":"auth.createAccount")}),e.jsx("p",{className:"mb-8 text-center text-muted-foreground",children:s(a?"auth.signInSubtitle":"auth.signUpSubtitle")}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[!a&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"displayName",children:s("auth.displayName")}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute start-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(N,{id:"displayName",type:"text",placeholder:s("auth.displayNamePlaceholder"),value:m,onChange:t=>h(t.target.value),className:"ps-10"})]}),d.displayName&&e.jsx("p",{className:"text-sm text-destructive",children:d.displayName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"email",children:s("auth.email")}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute start-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(N,{id:"email",type:"email",placeholder:s("auth.emailPlaceholder"),value:r,onChange:t=>x(t.target.value),className:"ps-10",required:!0})]}),d.email&&e.jsx("p",{className:"text-sm text-destructive",children:d.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"password",children:s("auth.password")}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute start-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(N,{id:"password",type:"password",placeholder:s("auth.passwordPlaceholder"),value:o,onChange:t=>g(t.target.value),className:"ps-10",required:!0})]}),d.password&&e.jsx("p",{className:"text-sm text-destructive",children:d.password})]}),e.jsx(L,{type:"submit",variant:"hero",size:"lg",className:"w-full",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4 animate-spin"}),s(a?"auth.signingIn":"auth.creatingAccount")]}):s(a?"auth.signIn":"auth.createAccount")})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-muted"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"Or continue with"})})]}),e.jsxs(L,{variant:"outline",type:"button",className:"w-full",onClick:()=>j(void 0,null,function*(){const{error:t}=yield q.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/`}});t&&n({title:"Error",description:t.message,variant:"destructive"})}),children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"})}),"Google"]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:()=>{p(!a),v({})},className:"text-sm text-muted-foreground transition-colors hover:text-foreground",children:s(a?"auth.noAccount":"auth.hasAccount")})})]})]})})]})};export{ae as default};
